<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="data:,">
  <meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="Finance" />

<meta name="theme-color" content="#ffffff" />
<link rel="manifest" href="/static/manifest.webmanifest" />
<link rel="apple-touch-icon" href="/static/icons/icon-192.png" />

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/static/css/base.css">
  <link rel="stylesheet" href="/static/css/mobile.css">
</head>

<body class="page-home">

  <!-- =============================================================================
       Page Container
       ============================================================================= -->
  <div class="page-container">

    <div id="homeChartMount"></div>

    <hr class="section-divider" />

    <!-- =============================================================================
     Upcoming (7-day mini calendar)
     ============================================================================= -->
<div id="upcomingMount" style="margin-top:14px;"></div>
    <hr class="section-divider" />
    <!-- =============================================================================
         Bank Totals + Monthly Spending Sidebar
         ============================================================================= -->
<section class="bank-area">

  <!-- LEFT SIDEBAR (stacked vertically) -->
<!-- Sidebar stack (Month budget + Monthly Spending) -->
<aside class="sidebar-stack">

  <!-- Month Budget (new) -->
  <div id="monthBudget" class="category-box category-box--sidebar" aria-label="Month budget">
    <div class="category-box__header">This month</div>

    <div class="month-budget__top">
      <div class="mb-kpi">
        <div class="mb-label">Safe to spend</div>
        <div class="mb-value" id="mbSafe">—</div>
      </div>
      <div class="mb-meta" id="mbMeta">—</div>
    </div>

    <div class="mb-bar" aria-hidden="true">
      <div class="mb-bar__fill" id="mbBarFill" style="width:0%"></div>
    </div>

    <ul class="category-box__list" style="margin-top:10px;">
      <li id="mbIncomeRow" class="category-pill" role="button" tabindex="0" style="cursor:pointer;" title="View expected income breakdown">
        <div class="cat-left"><span class="cat-name">Expected income</span></div>
        <span class="cat-amt" id="mbIncome">—</span>
      </li>
      <li class="category-pill is-static">
        <div class="cat-left"><span class="cat-name">Spent so far</span></div>
        <span class="cat-amt" id="mbSpent">—</span>
      </li>
      <li class="category-pill is-static">
        <div class="cat-left"><span class="cat-name">Remaining bills</span></div>
        <span class="cat-amt" id="mbBills">—</span>
      </li>
    </ul>
  </div>

  <!-- Monthly Spending (existing) -->
  <div id="categoryTotals" class="category-box category-box--sidebar">
    <div class="category-box__header">Monthly Spending</div>
    <ul id="categoryTotalsList" class="category-box__list"></ul>
  </div>

</aside>


  <!-- RIGHT MAIN -->
  <div class="bank-main">

        <div class="category-box bank-box-fill">
  <div class="category-box__header" id="bankTotalsHeader"
       style="display:flex; align-items:center; gap:8px;">
    <span>Bank Totals</span>

    <!-- Bank info button -->
    <button id="bankInfoBtn"
            class="icon-btn"
            title="Bank info"
            aria-label="Bank info">
      i
    </button>
  </div>

  <div id="bankTotals"></div>
</div>

      </div>

    </section>

    <hr id="txDivider" class="section-divider" />



    <!-- =============================================================================
         Transactions Table
         ============================================================================= -->
  <section aria-label="Transactions">
  <div class="category-box">
    <div class="category-box__header">Recent Transactions</div>
    <div id="txList" class="tx-list"></div>
  </div>
</section>



  </div><!-- /.page-container -->


  <!-- =============================================================================
       Rule Modal
       ============================================================================= -->
  <div
    id="ruleModalBackdrop"
    style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.35);"
  >
    <div
      id="ruleModal"
      style="max-width:520px; margin:8vh auto; background:#fff; border-radius:16px; padding:16px; box-shadow:0 10px 40px rgba(0,0,0,0.2);"
    >

      <!-- Modal header -->
      <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
        <h3 style="margin:0;">Create category rule</h3>
        <button id="ruleModalClose" type="button">✕</button>
      </div>

      <!-- Modal navigation -->
      <div style="margin-top:10px; display:flex; justify-content:space-between; align-items:center; gap:10px;">
        <button id="rulePrevBtn" type="button">◀ Prev</button>
        <div id="ruleCounter" style="opacity:0.75;"></div>
        <button id="ruleNextBtn" type="button">Next ▶</button>
      </div>

      <!-- Transaction preview -->
      <div style="margin-top:12px; border:1px solid #eee; border-radius:12px; padding:12px;">
        <div><strong>Description:</strong> <span id="ruleTxMerchant">—</span></div>
        <div><strong>Account:</strong> <span id="ruleTxAccount">—</span></div>
        <div><strong>Amount:</strong> <span id="ruleTxAmount">—</span></div>
        <div><strong>Date:</strong> <span id="ruleTxDate">—</span></div>
        <input type="hidden" id="ruleTxId" />
      </div>

      <!-- Rule form -->
      <div class="rule-form">
          <button id="unassignedToggle" class="btn">Most recent ▾</button>

        <div class="rule-field">
          <label for="ruleCategory">Category</label>
          <input id="ruleCategory" list="categoryOptions" placeholder="e.g. Food" />
          <datalist id="categoryOptions"></datalist>
        </div>

        <div class="rule-field">
          <label for="ruleKeywords">Keywords (comma-separated)</label>
          <input id="ruleKeywords" placeholder="e.g. chick-fil-a, chick fil a" />
        </div>

        <div class="rule-field checkbox">
          <label>
            <input id="ruleApplyNow" type="checkbox" checked />
            Apply to existing unassigned now
          </label>
        </div>

        <div class="rule-actions">
          <button id="ruleSaveBtn" type="button">Save rule</button>
        </div>

        <div id="ruleSaveMsg" class="rule-msg"></div>

      </div><!-- /.rule-form -->

    </div><!-- /#ruleModal -->
  </div><!-- /#ruleModalBackdrop -->



  <div id="bottomTabs"></div>

  <!-- ================================
     Bank Info Panel
================================ -->
<div id="bankInfoOverlay" class="overlay hidden"></div>

<div id="bankInfoPanel" class="side-panel hidden" role="dialog" aria-modal="true">
  <div class="panel-header">
    <div>
      <div class="panel-title">Bank info</div>
      <div class="panel-subtitle" id="bankInfoSubtitle">—</div>
    </div>

    <button id="bankInfoClose" class="icon-btn" aria-label="Close">✕</button>
  </div>

  <div class="panel-actions">
    <button id="bankRatesRefreshBtn" class="btn">
      Update interest rates
    </button>
  </div>

  <div id="bankInfoBody" class="panel-body">
    <!-- populated by JS -->
  </div>
</div>



<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/static/sw.js").catch(console.error);
  }
</script>

  <!-- =============================================================================
       Scripts
       ============================================================================= -->

<script src="/static/bankInfo.js"></script>
<script src="/static/profile.js"></script>
<script src="/static/bottomTabs.js"></script>
  <script src="/static/category_icons.js"></script>
<script src="/static/upcomingCard.js"></script>
  <script src="/static/chartControls.js"></script>
  <script src="/static/chartCard.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="/static/home.js"></script>
</body>
</html>
